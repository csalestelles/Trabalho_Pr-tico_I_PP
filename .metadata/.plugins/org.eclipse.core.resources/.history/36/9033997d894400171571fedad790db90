package BibliotecaSIS;

import java.sql.*;

import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.table.DefaultTableModel;

public class UsuarioDAO extends BancoDeDados {
	
	private Usuario usuario;
	private PreparedStatement statement;
	private ResultSet resultSet;
	private String men, sql;
	public BancoDeDados bd;
	
	public UsuarioDAO()
	{
		bd = new BancoDeDados();
		usuario = new Usuario();
	}
	
	public boolean adicionarUsuario(Usuario user)
	{
		try 
		{
			Statement st = conexao.createStatement();
			st.executeUpdate("INSERT INTO Usuarios VALUES (NULL ,'" + user.getNomeDeUsuario() + "', '" 
					+ user.getSenha() + "', " + user.getAnoDeNascimento());
			return true;
		}
		catch (SQLException e){return false;}
	}
	
	public void setTabela(JTable tabela, JScrollPane scroll) throws SQLException
	{
		String sql = "SELECT * FROM Usuarios";
		statement = bd.conexao.prepareStatement(sql);
		resultSet = statement.executeQuery();	
		
		@SuppressWarnings("serial")
		DefaultTableModel modelo = new DefaultTableModel(
				new String[]{}, 0) {	
				};
				
		
		int qtdColunas = resultSet.getMetaData().getColumnCount() - 1;		
		for(int indice = 1; indice <= qtdColunas; indice++)
		{
			modelo.addColumn(resultSet.getMetaData().getColumnName(indice+1));
		}
		
		tabela = new JTable(modelo);
		DefaultTableModel dtm = (DefaultTableModel) tabela.getModel();
		
		while(resultSet.next())
		{
			String[] dados = new String[qtdColunas];
			for(int i = 1; i <= qtdColunas; i++)
			{
				dados[i-1] = resultSet.getString(i+1);
			}
			
			dtm.addRow(dados);
			scroll.setViewportView(tabela);
		}
	}

}
